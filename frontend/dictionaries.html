<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>字典管理 - 英语词典系统</title>
    <!-- 引入Ant Design CSS -->
    <link rel="stylesheet" href="css/antd.min.css">
    <!-- 引入Ant Design JavaScript -->
    <script src="https://unpkg.com/antd@5.12.8/dist/antd.min.js"></script>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/dictionaries.css">
    <style>
        /* 保留必要的页面特定样式 */
        .search-container {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .btn {
            padding: 8px 16px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        .btn-primary {
            background-color: #1890ff;
            color: white;
            border-color: #1890ff;
        }
        .btn-primary:hover {
            background-color: #40a9ff;
            border-color: #40a9ff;
        }
        .btn-default:hover {
            border-color: #1890ff;
            color: #1890ff;
        }
        .search-input {
            width: 300px;
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s;
        }
        .search-input:focus {
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
        }
        .table-container {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }
        .table th {
            background-color: #fafafa;
            font-weight: 600;
            color: #333;
        }
        .table tr:hover {
            background-color: #fafafa;
        }
        .footer {
            text-align: center;
            padding: 24px;
            margin-top: 64px;
            color: #666;
            border-top: 1px solid #f0f0f0;
        }
        /* 模态框样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1001;
        }
        .modal-content {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        }
        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 18px;
            font-weight: bold;
            color: #333;
        }
        .modal-body {
            padding: 24px;
        }
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid #f0f0f0;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }
        /* 表单样式 */
        .form-item {
            margin-bottom: 24px;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        .form-input,
        .form-textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            font-size: 14px;
            outline: none;
            transition: all 0.3s;
        }
        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }
        .form-input:focus,
        .form-textarea:focus {
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24, 144, 255, 0.2);
        }
        .required {
            color: #ff4d4f;
            margin-left: 4px;
        }
        /* 开关样式 */
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #1890ff;
        }
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        .switch-label {
            margin-left: 8px;
            color: #666;
            font-size: 14px;
        }
        /* 表格操作按钮 */
        .table-btn {
            padding: 4px 12px;
            margin-right: 8px;
            font-size: 12px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
        }
        .view-btn {
            background-color: #e6f7ff;
            color: #1890ff;
        }
        .edit-btn {
            background-color: #fff7e6;
            color: #fa8c16;
        }
        .delete-btn {
            background-color: #fff2f0;
            color: #ff4d4f;
        }
        .table-btn:hover {
            opacity: 0.8;
        }
        /* 状态标签 */
        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        .status-enabled {
            background-color: #f6ffed;
            color: #52c41a;
            border: 1px solid #b7eb8f;
        }
        .status-disabled {
            background-color: #f5f5f5;
            color: #999;
            border: 1px solid #d9d9d9;
        }
        /* 单词列表模态框 */
        .words-modal-content {
            max-width: 800px;
        }
        .words-search-container {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-bottom: 16px;
        }
    </style>
</head>

<body>
    <!-- 顶部导航栏 -->
    <header class="header">
        <div class="header-content">
            <div class="logo">英语词典系统</div>
            <nav class="nav-menu">
                <a href="index.html" class="nav-item">首页</a>
                <a href="dictionaries.html" class="nav-item active">字典管理</a>
                <a href="words.html" class="nav-item">单词管理</a>
                <a href="word_search.html" class="nav-item">单词查询</a>
            </nav>
        </div>
    </header>

    <!-- 内容区域 -->
    <main class="content">
        <!-- 页面标题 -->
        <div class="page-header">
            <div class="breadcrumb">
                <span class="breadcrumb-item">系统管理</span>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-item active">字典管理</span>
            </div>
            <h1 class="page-title">字典管理</h1>
            <p class="page-description">管理你的英语单词字典集合</p>
        </div>

        <!-- 工具栏 -->
        <div class="toolbar">
            <div class="search-container">
                <input type="text" id="dictionary-filter" class="search-input" placeholder="搜索字典...">
            </div>
            <button id="add-dictionary-btn" class="btn btn-primary">
                ➕ 添加字典
            </button>
        </div>

        <!-- 字典列表 -->
        <div class="table-container">
            <div style="overflow-x: auto;">
                <table class="table" id="dictionaries-table">
                    <thead>
                        <tr>
                            <th>字典名称</th>
                            <th>描述</th>
                            <th>单词数量</th>
                            <th>状态</th>
                            <th>是否掌握</th>
                            <th>创建时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- 表格数据将通过JavaScript动态加载 -->
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #999;">
                                加载中...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <!-- 分页 -->
            <div style="margin-top: 16px; text-align: right;">
                <div id="pagination"></div>
            </div>
        </div>
    </main>

    <!-- 底部信息 -->
    <footer class="footer">
        &copy; 2024 英语词典系统. 保留所有权利.
    </footer>

    <!-- 添加/编辑字典模态框 -->
    <div id="dictionary-form-container" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header" id="modal-title">添加字典</div>
            <div class="modal-body">
                <form id="dictionary-form">
                    <input type="hidden" id="dictionary-id">
                    <div class="form-item">
                        <label class="form-label">字典名称 <span class="required">*</span></label>
                        <input type="text" id="dictionary-name" class="form-input" placeholder="例如: CET4/考研核心词" required>
                    </div>
                    <div class="form-item">
                        <label class="form-label">字典描述</label>
                        <textarea id="dictionary-description" class="form-textarea" rows="3" placeholder="详细介绍字典内容和用途"></textarea>
                    </div>
                    <div class="form-item">
                        <label class="form-label">字典状态</label>
                        <label class="switch">
                            <input type="checkbox" id="dictionary-enabled" checked>
                            <span class="slider"></span>
                        </label>
                        <span class="switch-label" id="enabled-label">启用</span>
                    </div>
                    <div class="form-item">
                        <label class="form-label">是否掌握</label>
                        <label class="switch">
                            <input type="checkbox" id="dictionary-mastered">
                            <span class="slider"></span>
                        </label>
                        <span class="switch-label" id="mastered-label">否</span>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button id="cancel-modal" class="btn btn-default">取消</button>
                <button id="save-dictionary" class="btn btn-primary">保存</button>
            </div>
        </div>
    </div>

    <!-- 查看字典单词模态框 -->
    <div id="dictionary-words-container" class="modal-overlay" style="display: none;">
        <div class="modal-content words-modal-content">
            <div class="modal-header" id="words-modal-title">字典单词列表</div>
            <div class="modal-body">
                <div class="words-search-container">
                    <input type="text" id="words-search" class="search-input" placeholder="搜索单词...">
                    <button id="add-words-to-dict" class="btn btn-primary">
                        ➕ 添加单词
                    </button>
                </div>
                <div style="overflow-x: auto;">
                    <table class="table" id="dictionary-words-table">
                        <thead>
                            <tr>
                                <th>单词</th>
                                <th>音标</th>
                                <th>释义</th>
                                <th>添加时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="words-table-body">
                            <tr>
                                <td colspan="5" style="text-align: center; padding: 40px; color: #999;">
                                    加载中...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                <button id="close-words-modal" class="btn btn-default">关闭</button>
            </div>
        </div>
    </div>

    <script>
        // 页面加载完成后的初始化逻辑
        document.addEventListener('DOMContentLoaded', function() {
            // 获取DOM元素
            const addDictionaryBtn = document.getElementById('add-dictionary-btn');
            const dictionaryFilter = document.getElementById('dictionary-filter');
            const formContainer = document.getElementById('dictionary-form-container');
            const wordsContainer = document.getElementById('dictionary-words-container');
            const cancelModal = document.getElementById('cancel-modal');
            const saveDictionary = document.getElementById('save-dictionary');
            const closeWordsModal = document.getElementById('close-words-modal');
            const addWordsToDict = document.getElementById('add-words-to-dict');
            const wordsSearch = document.getElementById('words-search');
            const enabledSwitch = document.getElementById('dictionary-enabled');
            const masteredSwitch = document.getElementById('dictionary-mastered');
            const enabledLabel = document.getElementById('enabled-label');
            const masteredLabel = document.getElementById('mastered-label');
            const modalTitle = document.getElementById('modal-title');
            const wordsModalTitle = document.getElementById('words-modal-title');
            const tableBody = document.getElementById('table-body');
            const wordsTableBody = document.getElementById('words-table-body');
            
            // 初始化表格数据
            function loadDictionaries() {
                // 暂时显示加载状态
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: #999;">
                            加载中...
                        </td>
                    </tr>
                `;
                
                // 模拟AJAX请求
                setTimeout(() => {
                    // 实际项目中应该从API获取数据
                    const dictionaries = [
                        { id: 1, name: 'CET-4核心词汇', description: '大学英语四级考试核心词汇1000个', wordCount: 1000, enabled: true, mastered: false, createTime: '2024-01-01 10:00:00' },
                        { id: 2, name: '考研核心词汇', description: '研究生入学考试必备词汇5500个', wordCount: 5500, enabled: true, mastered: false, createTime: '2024-01-02 14:30:00' },
                        { id: 3, name: '日常英语词汇', description: '日常生活中常用的英语词汇', wordCount: 2000, enabled: false, mastered: true, createTime: '2024-01-03 09:15:00' }
                    ];
                    
                    // 渲染表格
                    renderDictionaryTable(dictionaries);
                }, 500);
            }
            
            // 渲染字典表格
            function renderDictionaryTable(dictionaries) {
                if (dictionaries.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px; color: #999;">
                                暂无字典数据
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                tableBody.innerHTML = dictionaries.map(dict => `
                    <tr>
                        <td>${dict.name}</td>
                        <td>${dict.description}</td>
                        <td>${dict.wordCount}</td>
                        <td><span class="status-badge status-${dict.enabled ? 'enabled' : 'disabled'}">${dict.enabled ? '启用' : '禁用'}</span></td>
                        <td>${dict.mastered ? '是' : '否'}</td>
                        <td>${dict.createTime}</td>
                        <td>
                            <button class="table-btn view-btn" onclick="viewDictionaryWords(${dict.id}, '${dict.name}')">查看单词</button>
                            <button class="table-btn edit-btn" onclick="editDictionary(${dict.id})")>编辑</button>
                            <button class="table-btn delete-btn" onclick="deleteDictionary(${dict.id})")>删除</button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // 渲染单词表格
            function renderWordsTable(words) {
                if (words.length === 0) {
                    wordsTableBody.innerHTML = `
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 40px; color: #999;">
                                暂无单词数据
                            </td>
                        </tr>
                    `;
                    return;
                }
                
                wordsTableBody.innerHTML = words.map(word => `
                    <tr>
                        <td>${word.spelling}</td>
                        <td>${word.phonetic || '-'}</td>
                        <td>${word.definition}</td>
                        <td>${word.addTime}</td>
                        <td>
                            <button class="table-btn delete-btn" onclick="removeWordFromDictionary(${word.id})")>移除</button>
                        </td>
                    </tr>
                `).join('');
            }
            
            // 显示字典表单模态框
            function showDictionaryModal(title, isEdit = false, dictionary = null) {
                modalTitle.textContent = title;
                
                if (!isEdit) {
                    // 添加模式，清空表单
                    document.getElementById('dictionary-id').value = '';
                    document.getElementById('dictionary-name').value = '';
                    document.getElementById('dictionary-description').value = '';
                    enabledSwitch.checked = true;
                    masteredSwitch.checked = false;
                    enabledLabel.textContent = '启用';
                    masteredLabel.textContent = '否';
                } else if (dictionary) {
                    // 编辑模式，填充表单
                    document.getElementById('dictionary-id').value = dictionary.id;
                    document.getElementById('dictionary-name').value = dictionary.name;
                    document.getElementById('dictionary-description').value = dictionary.description;
                    enabledSwitch.checked = dictionary.enabled;
                    masteredSwitch.checked = dictionary.mastered;
                    enabledLabel.textContent = dictionary.enabled ? '启用' : '禁用';
                    masteredLabel.textContent = dictionary.mastered ? '是' : '否';
                }
                
                formContainer.style.display = 'flex';
            }
            
            // 显示单词列表模态框
            function showWordsModal(dictionaryId, dictionaryName) {
                wordsModalTitle.textContent = `${dictionaryName} - 单词列表`;
                
                // 加载单词数据
                wordsTableBody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: #999;">
                            加载中...
                        </td>
                    </tr>
                `;
                
                // 模拟加载单词数据
                setTimeout(() => {
                    const words = [
                        { id: 1, spelling: 'apple', phonetic: '/ˈæpl/', definition: 'n. 苹果', addTime: '2024-01-01 10:00:00' },
                        { id: 2, spelling: 'banana', phonetic: '/bəˈnɑːnə/', definition: 'n. 香蕉', addTime: '2024-01-01 10:01:00' },
                        { id: 3, spelling: 'orange', phonetic: '/ˈɒrɪndʒ/', definition: 'n. 橙子', addTime: '2024-01-01 10:02:00' }
                    ];
                    renderWordsTable(words);
                }, 500);
                
                wordsContainer.style.display = 'flex';
            }
            
            // 隐藏字典表单模态框
            function hideDictionaryModal() {
                formContainer.style.display = 'none';
            }
            
            // 隐藏单词列表模态框
            function hideWordsModal() {
                wordsContainer.style.display = 'none';
            }
            
            // 全局函数，供表格按钮调用
            window.viewDictionaryWords = function(id, name) {
                showWordsModal(id, name);
            }
            
            window.editDictionary = function(id) {
                // 模拟获取字典数据
                const dictionary = { 
                    id, 
                    name: '示例字典', 
                    description: '示例描述', 
                    enabled: true, 
                    mastered: false 
                };
                showDictionaryModal('编辑字典', true, dictionary);
            }
            
            window.deleteDictionary = function(id) {
                if (confirm(`确定要删除ID为 ${id} 的字典吗？`)) {
                    // 这里应该发送删除请求
                    alert(`删除字典ID: ${id}`);
                    loadDictionaries(); // 重新加载数据
                }
            }
            
            window.removeWordFromDictionary = function(wordId) {
                if (confirm(`确定要从字典中移除该单词吗？`)) {
                    // 这里应该发送移除请求
                    alert(`移除单词ID: ${wordId}`);
                    // 重新加载单词列表
                    const currentDictId = 1; // 实际应该从当前打开的字典获取ID
                    const currentDictName = document.getElementById('words-modal-title').textContent.split(' - ')[0];
                    showWordsModal(currentDictId, currentDictName);
                }
            }
            
            // 事件监听
            addDictionaryBtn.addEventListener('click', function() {
                showDictionaryModal('添加字典', false);
            });
            
            cancelModal.addEventListener('click', hideDictionaryModal);
            
            closeWordsModal.addEventListener('click', hideWordsModal);
            
            saveDictionary.addEventListener('click', function() {
                const id = document.getElementById('dictionary-id').value;
                const name = document.getElementById('dictionary-name').value;
                const description = document.getElementById('dictionary-description').value;
                const enabled = document.getElementById('dictionary-enabled').checked;
                const mastered = document.getElementById('dictionary-mastered').checked;
                
                if (!name.trim()) {
                    alert('请输入字典名称');
                    return;
                }
                
                const isEdit = id !== '';
                console.log(isEdit ? '更新字典' : '添加字典', { id, name, description, enabled, mastered });
                
                // 这里应该发送添加或更新请求
                alert(isEdit ? `更新字典成功: ${name}` : `添加字典成功: ${name}`);
                hideDictionaryModal();
                loadDictionaries(); // 重新加载数据
            });
            
            addWordsToDict.addEventListener('click', function() {
                // 这里应该打开添加单词到字典的界面
                alert('添加单词到字典功能');
            });
            
            enabledSwitch.addEventListener('change', function() {
                enabledLabel.textContent = this.checked ? '启用' : '禁用';
            });
            
            masteredSwitch.addEventListener('change', function() {
                masteredLabel.textContent = this.checked ? '是' : '否';
            });
            
            dictionaryFilter.addEventListener('input', function() {
                const filterText = this.value.toLowerCase();
                console.log('过滤字典:', filterText);
                // 实际项目中应该根据输入实时过滤或发送搜索请求
            });
            
            wordsSearch.addEventListener('input', function() {
                const searchText = this.value.toLowerCase();
                console.log('搜索单词:', searchText);
                // 实际项目中应该根据输入实时过滤或发送搜索请求
            });
            
            // 点击模态框外部关闭模态框
            formContainer.addEventListener('click', function(e) {
                if (e.target === formContainer) {
                    hideDictionaryModal();
                }
            });
            
            wordsContainer.addEventListener('click', function(e) {
                if (e.target === wordsContainer) {
                    hideWordsModal();
                }
            });
            
            // 初始加载数据
            loadDictionaries();
        });
    </script>
</body>

</html>